import common
import numpy as np
import matplotlib.pyplot as plt

def go(outputfilename):
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(3.6, 6))

    # this data is from Segre & Pusey 1996 fig 1b
    QR = np.array([0.862,1.031,1.196,1.369,1.551,1.724,1.88,2.219,2.392,2.524,2.647,2.755,2.837,2.953,3.027,3.068,3.109,3.159,3.249,3.299,3.365,3.414,3.513,3.546,3.604,3.703,3.843,4.033,4.181,4.602,5.097,5.757,6.054,6.309,7.212])
    DsQ_ov_D0 = 1/np.array([0.698,0.726,0.754,0.811,0.868,0.94,0.954,1.181,1.395,1.637,1.865,2.135,2.662,2.947,3.359,3.587,3.972,4.413,5.409,5.936,6.292,6.648,6.875,6.406,5.893,5.552,4.783,4.456,3.587,3.288,3.786,4.384,4.199,4.641,4.399])

    # L_ov_R = 2*np.pi/QR
    ax1.scatter(QR, DsQ_ov_D0)
    ax1.loglog()
    ax1.set_xlabel('$kr$')
    ax1.set_ylabel('$D_c(k)/D_0$')
    ax1.set_title('Segr√® and Pusey 1996, $\phi=0.47$')

    # this is Banchio et al 2018 fig 6 (top)
    q = np.array([0.004,0.005,0.005,0.006,0.006,0.007,0.007,0.008,0.008,0.009,0.009,0.01,0.011,0.011,0.012,0.012,0.013,0.013,0.013,0.014,0.014,0.015,0.015,0.015,0.015,0.016,0.016,0.016,0.016,0.017,0.017,0.017,0.017,0.017,0.018,0.018,0.018,0.018,0.018,0.019,0.019,0.019,0.019,0.019,0.019,0.02,0.02,0.021,0.021,0.021,0.022,0.022,0.023,0.023,0.024,0.024,0.025,0.025,0.026,0.026,0.027,0.027,0.028,0.028])
    Dsq_ov_d0 = 1/np.array([0.088,0.088,0.105,0.105,0.123,0.123,0.123,0.14,0.14,0.149,0.167,0.175,0.211,0.263,0.281,0.281,0.368,0.439,0.491,0.579,0.711,0.886,1.053,1.149,1.342,1.561,1.746,2,2.193,2.439,2.649,2.719,2.807,2.754,2.623,2.456,2.333,2.114,1.921,1.825,1.719,1.623,1.509,1.421,1.351,1.246,1.193,1.132,1.088,1.061,0.991,0.974,0.965,0.965,0.982,1.009,1.009,1.044,1.105,1.158,1.219,1.246,1.386,1.43])
    r = 136

    # L = 2*np.pi/q / r

    ax2.scatter(q*r, Dsq_ov_d0)
    ax2.loglog()
    ax2.set_xlabel('$kr$')
    ax2.set_ylabel('$D_c(k)/D_0$')
    ax2.set_title('Banchio et al 2018, $\phi=0.15$')

    # Riese et al 2000: might actually show Dc plateau
    # {"x":[0.006,0.008,0.011,0.014,0.016,0.019,0.021,0.023,0.025,0.027,0.028,0.032,0.034,0.036,0.038,0.04,0.041,0.043,0.047]
    #  "y":[0.23,0.201,0.208,0.245,0.245,0.253,0.29,0.401,0.401,0.52,0.699,1.19,1.97,2.55,3.086,3.249,3.123,2.788,1.866]}

    common.save_fig(fig, outputfilename, hide_metadata=True)

if __name__ == '__main__':
    go('visualisation/figures_png/Dc_literature.png')